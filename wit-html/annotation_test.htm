<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Automation Images</title>
    <style type="text/css">
        h1 { font-size: 2em; }
        h2 { font-size: 1.5em; }
        h3 { font-size: 1.17em; }
        h4 { font-size: 1.12em; }
        h5 { font-size: .83em; }
        h6 { font-size: .67em; }

        html *
        {
            font-family: Arial;
        }

        #logoback {
            transition: all 0.15s;
            background-color: #edebfc;
            border: 2px solid;
            border-color: #edebfc;
            position:absolute;
            top:1.25em;
            left:0.9375em;
            width:5.75em;
            height:5.75em;
            color:black;
            box-sizing:border-box;
            line-height:5.75em;
            border-radius:2.875em;
            box-shadow:0px 0px 1.25em 1px #000080;"

        }
        #logoback:hover {
            /*background-color: #c7cfff;*/
            border-color: #848ff8;
        }
        #logo
        {
            position:relative;
            top:0.5em;
            left:0.5625em;
            transition: all 0.1s;
            width:4.375em;
            height:4.375em;

        }
        #logo:hover
        {
            /*top:6px;*/
            /*transform: rotate(10deg);*/
        }
        #logo:hover:active {
            width:5em;
            height:5em;
            left:0.25em;
            top:0.0625em;
        }

        div.bt {

            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;

            display:inline-block;
            color:black;
            font-size:13px;
            border: 1px solid;
            padding:2px 15px 2px 15px;
            border-color: #8696b2;
            background-color: #c5d4fc;
            box-shadow: inset 0 -5px 5px 0 #a6c1e7;
        }
        div.bt:hover {
            cursor: pointer;
            /*box-shadow: inset 0 -5px 15px 0 #7c94b7;*/
            background-color: #a9bdff;
            border-color: #2130ba;
        }
        div.bt:hover:active {
            background-color: #a5c3ee;
            box-shadow: inset 0 2px 5px 0 #7c94b7;
        }
        div.linky {
            transition: all 0.15s;
            display:none;
            background-color: #c5d4fc;
            border: 2px solid;
            border-color: #c5d4fc;
            /*border-color: #8696b2;*/
            padding:0px 1.25em 0px 1.25em;
            color:black;
            height:2.25em;
            line-height:2.25em;
            box-sizing:border-box;
            border-radius:1.25em;
            margin:0 auto;
            box-shadow:0 0 20px 1px #000080;
            cursor: pointer;

        }
        div.linky:hover {
           /* background-color: #a5c3ee;*/
            border-color: #848ff8;

        }

        div.pos-resetter {
            width:100%;
            display:inline-block;
            text-align:center;
            position:absolute;
            margin:0 auto;
        }
        img.centred {
            position: absolute;
            top: -9999px;
            left: -9999px;
            bottom: -9999px;
            right: -9999px;
            margin:auto;
        }
    </style>
    <script>
        console.log( "Protocol is "+window.location.protocol);
        if (window.location.protocol == "http:"){
            console.log("Http: detected");
            if( window.location.href.indexOf("localhost") < 0 )
                window.location.href = "https:" + window.location.href.slice(5);
        }

        var Message;
        var Message2;
        var Overlay;
        var MainDiv;
        var DetailDiv;
        var GuiCanvas;

        function getDivs(){
            if( !Message ){
                Message= document.getElementById("message");
                Message2= document.getElementById("message2");
                MainDiv= document.getElementById("maindiv");
                DetailDiv= document.getElementById("detaildiv");
                GuiCanvas = document.getElementById("guicanvas");
                GuiCanvas.ctx = GuiCanvas.getContext('2d');
                drawFocusSpot( 800,200 );
            }
            //if( !Overlay ){
            //    Overlay= document.getElementById("overlay");
            // }

        }

        function antiPosition( x,y ){
            var pt = {};
            // get position as somewhere in range -1..+1
            var vx = x/500.0 -1;
            var vy = y/350.0 -1;

            // if vx non zero, round to opposite extremes,
            // i.e. negative to +1, positive to -1
            if( vx ){
               vx= -vx/Math.abs(vx);
            }else {
               // otherwise default to -1, far left.
               vx=-1;
            }

            // Message2.innerHTML = "Vec: ("+vx+","+vy+")";
            pt.x = (vx+1) * (1000-400) * 0.5;
            pt.y = (vy+1) * (700-300) * 0.5;

            return pt;
        }

        function drawFocusSpot( x, y ){
            var ctx= GuiCanvas.ctx;
            ctx.globalCompositeOperation = 'source-over';
            ctx.clearRect(0,0,1000,700);
            ctx.fillStyle = "rgba( 255,255,255,0.5)";
            ctx.fillRect(5,5,990,690);

            ctx.fillStyle = "rgba(0,255,255,1.0)";
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc( x, y, 150, 0, Math.PI * 2.0, true );
            ctx.closePath();
            ctx.fill();
            ctx.fillRect( x,y,30,30 );

        }

        function mousemoveOnMap(e){
            getDivs();

            if( Message ){
                var x = e.clientX -MainDiv.offsetLeft;
                var y = e.clientY -MainDiv.offsetTop;
                var coordinates = "Coordinates: (" + x + "," + y + ")";

                var pt = antiPosition( x, y);
                drawFocusSpot( x,y );
                Message.innerHTML = coordinates;
                DetailDiv.style.left = pt.x+"px";
                DetailDiv.style.top = pt.y+"px";
            }

        }
    </script>
</head>
<body style="color:white;background-image:url(images/header-home-bg.jpg);margin:0px;background-attachment:fixed;">
<div style="width:100%; text-align:center;background:#1d2134;height:5em;margin: 0px;">
    <h1 style="margin:0px;padding-top:0.65em;padding-bottom:0.9em;"><em>Audacity Toolbox</em>: Image Annotation Test</h1>
    <div style="width:100%; text-align:center;background:#303b70;position:relative;height:1.8em;top:-0.6em;box-shadow: inset 0 0px 4px 0px #000080, 0 -2px 7px -2px #618ef4;"></div>
</div>
<div style="width:100%;position:relative;top:-0.50em;left:0;display:inline-block;margin:0 auto;height:3em;">
    <div class='pos-resetter'>
        <h2 id="click-tip" style="color:#bfbfbf;display:block;position:relative;top:-0.55em;transition:opacity 4s;opacity:1;"><em>11-Nov-2019</em></h2>
    </div>
    <div class='pos-resetter'>
        <div style="display:inline-block;">
            <div class='linky' id="manual-url-holder">
                Manual's URL, here</div> &nbsp;
            <div class='linky' id="wit-url-holder">
                WIT's URL, here</div> &nbsp;
            <div class='linky' id="doxy-url-holder">
                Doxygen's URL, here</div>
        </div>
    </div>
</div>
<a  href="https://www.audacityteam.org">
    <div id="logoback" >
        <img id='logo' src="images/audacity-logo.png">
    </div>
</a>
<div style="height:1.9em;"></div>
<div style="text-align:center;">
    <div id="maindiv" style="width:1000px;height:700px;position:relative;display:inline-block;margin-left:auto;margin-right:auto;overflow:hidden" onmousemove="mousemoveOnMap(event)">

       <img class="centred" src='./images/Cambridge.png' >
        <canvas id="guicanvas"
                style="position:absolute;left:0px;top:0px;"
                width="1000px"
                height="700px"></canvas>
        <div id="detaildiv"
                style="background-color:rgba(0,0,0,0.6);position:absolute;left:0px;top:0px;height:300px;width:400px"><h1>Some Text</h1></div>


    </div>
    <br><em>Annotated Map</em><br>
</div>
<div id="message"></div>
<div id="message2"></div>
<img id="Gui" src="./images/blank-links.png"
     style="display:none;"
     alt="Audacity">
<p> This is a test of the annotation component of the Audacity Interactive Diagrams Toolkit.
<ul>
    <li>Lighter focus spot follows the cursor around</li>
    <li>Darker detail panel moves out the way of the cursor.
    </li></ul>
Still to do - actually put some stuff on the detail panel.  Use an image map thingy for a more refined focus spot.</p>

</body>
</html>